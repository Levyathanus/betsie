(function(){"use strict";var X="bezier3",B="line",_=Math.abs,p=Math.asin,g=Math.cos,G=Math.max,J=Math.min,Y=Math.PI,q=Math.pow,N=Math.sin,x=Math.sqrt,lr=Math.tan,K=1e-6;function i(r){return r[0]}function v(r){return r[1]}function O(r){return function(t){return t.reduce(function(a,h,M,o){return M%r?a:a.concat([o.slice(M,M+r)])},[])}}var or=O(3),mr=O(2);function $(r){return parseFloat(r,10)}function Z(r,t){return Math.abs(i(r)-i(t))<1e-10&&Math.abs(v(r)-v(t))<1e-10}function Mr(r,t){return[G(i(r),i(t)),G(v(r),v(t))]}function br(r,t){return[J(i(r),i(t)),J(v(r),v(t))]}function z(r,t){return[i(r)*t,v(r)*t]}function S(r,t){return[i(r)+i(t),v(r)+v(t)]}function Q(r,t){return i(r)*i(t)+v(r)*v(t)}function F(r,t,a){return[i(r)+(i(t)-i(r))*a,v(r)+(v(t)-v(r))*a]}function dr(r,t){var a=[],h=r;return h!==0&&a.push(-t/r),a}function Cr(r,t,a){var h=[];if(_(r)<=K)return dr(t,a);var M=r,o=t/M,C=a/M,l=o*o-4*C;if(l>0){var k=x(l);h.push(.5*(-o+k)),h.push(.5*(-o-k))}else l===0&&h.push(.5*-o);return h}function wr(r,t,a,h){if(_(r)<=K)return Cr(t,a,h);var M=[],o=r,C=t/o,l=a/o,k=h/o,d=(3*l-C*C)/3,c=(2*C*C*C-9*l*C+27*k)/27,w=C/3,A=c*c/4+d*d*d/27,I=c/2,n;if(A>0){var f=x(A);n=-I+f;var L=n>=0?q(n,1/3):-q(-n,1/3);n=-I-f,n>=0?L+=q(n,1/3):L-=q(-n,1/3),M.push(L-w)}else if(A<0){var u=x(-d/3),s=Math.atan2(x(-A),-I)/3,b=g(s),e=N(s),m=x(3);M.push(2*u*b-w),M.push(-u*(b+m*e)-w),M.push(-u*(b-m*e)-w)}else I>=0?n=-q(I,1/3):n=q(-I,1/3),M.push(2*n-w),M.push(-n-w);return M}function j(r,t,a,h,M,o,C,l){function k(W,fr,sr){var hr=g(sr),cr=N(sr);return[W*hr-fr*cr,W*cr+fr*hr]}var d=i(r),c=v(r),w=i(C),A=v(C),I=Y/180*(+h||0),n=0,f=0,L,u,s=[];if(l)n=l[0],f=l[1],L=l[2],u=l[3];else{var b=k(d,c,-I);d=i(b),c=v(b),b=k(w,A,-I),w=i(b),A=v(b);var e=(d-w)/2,m=(c-A)/2,T=e*e/(t*t)+m*m/(a*a);T>1&&(T=x(T),t=T*t,a=T*a);var U=t*t,H=a*a,V=(M===o?-1:1)*x(_((U*H-U*m*m-H*e*e)/(U*m*m+H*e*e)));L=V*t*m/a+(d+w)/2,u=V*-a*e/t+(c+A)/2,n=p(((c-u)/a).toFixed(9)),f=p(((A-u)/a).toFixed(9)),n=d<L?Y-n:n,f=w<L?Y-f:f,n<0&&(n=Y*2+n),f<0&&(f=Y*2+f),o&&n>f&&(n=n-Y*2),!o&&f>n&&(f=f-Y*2)}var P=f-n;if(_(P)>Y*120/180){var Ir=f,Pr=w,Br=A;f=n+Y*120/180*(o&&f>n?1:-1),w=L+t*g(f),A=u+a*N(f),s=j([w,A],t,a,h,0,o,[Pr,Br],[f,Ir,L,u])}P=f-n;var Sr=g(n),Xr=N(n),Yr=g(f),zr=N(f),rr=lr(P/4),ar=4/3*t*rr,tr=4/3*a*rr,er=[d,c],D=[d+ar*Xr,c-tr*Sr],nr=[w+ar*zr,A-tr*Yr],ir=[w,A];D[0]=2*er[0]-D[0],D[1]=2*er[1]-D[1];function vr(W){return or(mr(W))}if(l)return vr([D,nr,ir].concat(s));s=[D,nr,ir].concat(s).join().split(",");for(var ur=[],R=0,Rr=s.length;R<Rr;R++)ur[R]=R%2?k(s[R-1],s[R],I)[1]:k(s[R],s[R+1],I)[0];return vr(ur)}function y(r){if(typeof r!="string")throw new Error("Polygon should be a path string");var t=null,a=null,h=[],M=r;function o(){r=r.trim()}function C(u){for(var s=r.charCodeAt(u);s>=48&&s<=57;)u++,s=r.charCodeAt(u);return u}function l(){o();var u=0,s=0;r[u]===","&&(u++,s++),(r[u]==="-"||r[u]===".")&&s++,s=C(s),r[s]==="."&&r[u]!=="."&&(s++,s=C(s));var b=r.substring(u,s);if(b!==""){var e=$(b);if(r=r.substring(s),r.length&&r[0].toLowerCase()==="e"){var m=0;r.length>1&&r[1]==="-"?m=C(2):m=C(1);var T=$(r.substring(1,m));_(T)>0&&(e*=q(10,T)),r=r.substring(m)}return e}else throw new Error("Expected number: "+r)}function k(u,s){o();for(var b=0,e=r.charCodeAt(0);e>=48&&e<=57||e===44||e===45||e===46;){for(var m=[],T=0;T<u;T++)m.push(l());s(m,b),o(),e=r.charCodeAt(0),b++}}function d(u,s){k(u*2,function(b,e){for(var m=[],T=0;T<u;T++)m.push(b.splice(0,2));s(m,e)})}function c(u,s){return function(b){s&&(b=b.map(function(e){return[i(e)+i(a),v(e)+v(a)]})),b.unshift(a),h.push({type:u,coords:b}),a=b[b.length-1]}}function w(u){return[u[0],[i(u[0])+2/3*(i(u[1])-i(u[0])),v(u[0])+2/3*(v(u[1])-v(u[0]))],[i(u[2])+2/3*(i(u[1])-i(u[2])),v(u[2])+2/3*(v(u[1])-v(u[2]))],u[2]]}function A(){var u=h[h.length-1],s=null;if(!u||u.type!==X)s=a;else{var b=u.coords[2],e=i(a)-i(b),m=v(a)-v(b);s=[i(a)+e,v(a)+m]}return s}function I(u){k(7,function(s){for(var b=S(s.slice(5,7),u),e=[a].concat(s.slice(0,5)).concat([b]),m=j.apply(null,e),T=0;T<m.length;T++)c(X)(m[T])})}function n(){if(o(),r!==""){var u=r[0];r=r.substring(1);var s=c(B),b=[0,0];switch(u){case"M":d(1,function(e,m){m===0?(a=e[0],t||(t=a)):c(B)(e)});break;case"m":d(1,function(e,m){if(m===0)a?a=S(e[0],a):a=e[0],t||(t=a);else{var T=e[0];c(B)([S(T,a)])}});break;case"C":d(3,c(X));break;case"c":d(3,c(X,!0));break;case"Q":d(2,function(e){e.unshift(a),e=w(e),e.shift(),c(X)(e)});break;case"q":d(2,function(e){e=e.map(function(m){return S(m,a)}),e.unshift(a),e=w(e),e.shift(),c(X)(e)});break;case"S":d(2,function(e){var m=A();e.unshift(m),c(X)(e)});break;case"s":d(2,function(e){var m=A();e=e.map(function(T){return S(T,a)}),e.unshift(m),c(X)(e)});break;case"A":I(b);break;case"a":I(a);break;case"L":d(1,c(B));break;case"l":d(1,function(e){s([[i(e[0])+i(a),v(e[0])+v(a)]])});break;case"H":c(B)([[l(),v(a)]]);break;case"h":c(B,!0)([[l(),0]]);break;case"V":c(B)([[i(a),l()]]);break;case"v":c(B,!0)([[0,l()]]);break;case"Z":case"z":Z(a,t)||c(B)([t]);break;default:throw new Error("Unknown operator: "+u+" for polygon '"+M+"'")}}}for(;r.length>0;)n();for(var f=0;f<h.length;f++){var L=h[f];L.type===B&&Z(L.coords[0],L.coords[1])&&(h.splice(f,1),f--)}return h}function kr(r,t,a,h,M,o){var C=[],l=br(M,o),k=Mr(M,o),d=z(r,-1),c=z(t,3),w=z(a,-3),A=S(d,S(c,S(w,h)));d=z(r,3),c=z(t,-6),w=z(a,3);var I=S(d,S(c,w));d=z(r,-3),c=z(t,3);for(var n=S(d,c),f=r,L=[v(M)-v(o),i(o)-i(M)],u=i(M)*v(o)-i(o)*v(M),s=wr(Q(L,A),Q(L,I),Q(L,n),Q(L,f)+u),b=0;b<s.length;b++){var e=s[b];if(e>=0&&e<=1){var m=F(r,t,e),T=F(t,a,e),U=F(a,h,e),H=F(m,T,e),V=F(T,U,e),P=F(H,V,e);i(M)===i(o)?v(l)<=v(P)&&v(P)<=v(k)&&C.push(P):v(M)===v(o)?i(l)<=i(P)&&i(P)<=i(k)&&C.push(P):i(l)<=i(P)&&i(P)<=i(k)&&v(l)<=v(P)&&v(P)<=v(k)&&C.push(P)}}return C}function Ar(r,t,a,h){var M=(i(h)-i(a))*(v(r)-v(a))-(v(h)-v(a))*(i(r)-i(a)),o=(i(t)-i(r))*(v(r)-v(a))-(v(t)-v(r))*(i(r)-i(a)),C=(v(h)-v(a))*(i(t)-i(r))-(i(h)-i(a))*(v(t)-v(r));if(C!==0){var l=M/C,k=o/C;if(l>=0&&l<=1&&k>=0&&k<=1)return[[i(r)+l*(i(t)-i(r)),v(r)+l*(v(t)-v(r))]]}return[]}function Tr(r,t,a){var h=a.coords;switch(a.type){case X:return kr(h[0],h[1],h[2],h[3],r,t);case B:return Ar(h[0],h[1],r,t);default:throw new Error("Unsupported shape type: "+a.type)}}function Lr(r,t){var a;t&&Array.isArray(t)?a=t:a=y(t);for(var h=0,M=0,o=0;o<a.length;o++)for(var C=a[o].coords,l=0;l<C.length;l++){var k=C[l];h=Math.min(h,i(k)),M=Math.min(M,v(k))}for(var d=[h-10,M-10],c=[],w=0;w<a.length;w++)for(var A=Tr(d,r,a[w]),I=0;I<A.length;I++){for(var n=!1,f=A[I],L=0;L<c.length;L++)if(Z(c[L],f)){n=!0;break}n||c.push(f)}return c.length%2===1}var E={isInside:Lr,segments:y};addEventListener("message",r=>{const t=new Array;let a=new Array;const h=r.data.minYTopCp,M=r.data.maxYBottomCp,o=r.data.minXLeftCp,C=r.data.maxXRightCp,l=E.segments(r.data.path);for(let n=h;n<M;n++)for(let f=o;f<C;f++)E.isInside([f,n],l)||(E.isInside([f-1,n],l)&&a.push({x:f,y:n}),E.isInside([f+1,n],l)&&a.push({x:f,y:n}),E.isInside([f,n-1],l)&&a.push({x:f,y:n}),E.isInside([f,n+1],l)&&a.push({x:f,y:n}));let k=Math.min(...a.flatMap(n=>n.x)),d=Math.max(...a.flatMap(n=>n.x)),c=Math.min(...a.flatMap(n=>n.y)),w=Math.max(...a.flatMap(n=>n.y));for(let n=c;n<w;n++)for(let f=k;f<d;f++)E.isInside([f,n],l)?t.push({x:f,y:n,inside:!0}):t.push({x:f,y:n,inside:!1});const A=d-k,I=w-c;postMessage({rawData:t,width:A,height:I})})})();
